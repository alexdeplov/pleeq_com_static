#include <X11/Xlib.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MENU_WIDTH 100
#define MENU_HEIGHT 50

int main() {
    Display *display;
    Window root, menu;
    XEvent event;
    GC gc;
    XSetWindowAttributes attrs;
    int screen;
    char *menu_items[] = {"Option 1", "Option 2"};
    int num_items = 2;

    display = XOpenDisplay(NULL);
    if (!display) {
        fprintf(stderr, "Unable to open X display\n");
        exit(1);
    }

    screen = DefaultScreen(display);
    root = RootWindow(display, screen);

    attrs.override_redirect = True;
    attrs.background_pixel = WhitePixel(display, screen);

    menu = XCreateWindow(display, root, 100, 100, MENU_WIDTH, MENU_HEIGHT,
                         0, CopyFromParent, InputOutput, CopyFromParent,
                         CWOverrideRedirect | CWBackPixel, &attrs);

    gc = XCreateGC(display, menu, 0, NULL);
    XSetForeground(display, gc, BlackPixel(display, screen));

    XSelectInput(display, menu, ExposureMask | ButtonPressMask);
    XMapWindow(display, menu);

    while (1) {
        XNextEvent(display, &event);
        if (event.type == Expose) {
            for (int i = 0; i < num_items; i++) {
                XDrawString(display, menu, gc, 10, 15 + i * 20,
                            menu_items[i], strlen(menu_items[i]));
            }
        } else if (event.type == ButtonPress) {
            int y = event.xbutton.y;
            int selected = y / 20;
            if (selected >= 0 && selected < num_items) {
                printf("Selected: %s\n", menu_items[selected]);
                // Perform action based on selection
                if (selected == 0) {
                    // Action for Option 1
                } else if (selected == 1) {
                    // Action for Option 2
                }
                break; // Exit after selection
            }
        }
    }

    XDestroyWindow(display, menu);
    XCloseDisplay(display);
    return 0;
}
